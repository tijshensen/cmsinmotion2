Array.prototype.filter||(Array.prototype.filter=function(e){"use strict";if(null==this)throw new TypeError;var t=Object(this),o=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var s=[],r=arguments[1],n=0;o>n;n++)if(n in t){var i=t[n];e.call(r,i,n,t)&&s.push(i)}return s}),function($){function e(e,t,o){var s=t[1]-t[0],r=o[1]-o[0];return t[0]-o[0]>=0&&t[0]-o[0]<r?!0:t[0]-o[0]<=0&&t[0]+s>o[0]?!0:!1}var t={spytarget:window,scrolltopoffset:0,scrollbehavior:"smooth",scrollduration:500,highlightclass:"selected",enableprogress:"",mincontentheight:30},o=/iPhone|iPad|iPod/i.test(navigator.userAgent);$.fn.ddscrollSpy=function(s){var r=$(window),n=$(window.opera?"CSS1Compat"==document.compatMode?"html":"body":"html,body");return this.each(function(){function i(e){var t=e.find('a[href^="#"]');h=[],g="",v=0,t.each(function(e){var t=$(this),o=$(t.attr("href")),s=o.get(0),r=null;if(0==o.length)return!0;t.off("click.goto").on("click.goto",function(o){if(f.spytarget!=window||"jump"!=f.scrollbehavior&&history.pushState||(window.location.hash=t.attr("href")),"smooth"==f.scrollbehavior||0!=f.scrolltopoffset){var s=f.spytarget==window?n:c,r=1;"smooth"!=f.scrollbehavior||!history.pushState&&f.spytarget==window?s.prop("scrollTop",h[e].offsettop+r):s.animate({scrollTop:h[e].offsettop+r},f.scrollduration,function(){f.spytarget==window&&history.pushState&&history.pushState(null,null,t.attr("href"))}),o.preventDefault()}}),f.enableprogress&&(0==t.find("div."+f.enableprogress).length&&(t.css({position:"relative",overflow:"hidden"}),$('<div class="'+f.enableprogress+'" style="position:absolute; left: -100%" />').appendTo(t)),r=t.find("div."+f.enableprogress));var i=f.spytarget==window?o.offset().top:s.offsetParent==f.spytarget?s.offsetTop:s.offsetTop-f.spytarget.offsetTop;i+=f.scrolltopoffset;var a=parseInt(o.data("spyrange"))>0?parseInt(o.data("spyrange")):o.outerHeight()||f.mincontentheight,l=i+a;-1==p&&l>d-u&&(p=e),h.push({$menuitem:t,$des:o,offsettop:i,height:a,$progress:r,index:e})}),h.length>0&&(v=h[h.length-1].offsettop+h[h.length-1].height)}function a(){if(0!=h.length){var t=g,o=c.scrollTop(),s=!1,r=h.filter(function(t,s){return e(t,[t.offsettop,t.offsettop+t.height],[o,o+u])});if(r.length>0){if(g=r.shift(),t&&t!=g&&t.$menuitem.removeClass(f.highlightclass),g.$menuitem.hasClass(f.highlightclass)||g.$menuitem.addClass(f.highlightclass),g.index>=p&&o>=d-u){if(f.enableprogress)for(var n=0;n<h.length;n++)h[n].$menuitem.find("div."+f.enableprogress).css("left",0);return g.$menuitem.removeClass(f.highlightclass),g=h[h.length-1],void(g.$menuitem.hasClass(f.highlightclass)||g.$menuitem.addClass(f.highlightclass))}if(f.enableprogress){var i=(o-g.offsettop)/g.height*100;g.$menuitem.find("div."+f.enableprogress).css("left",-100+i+"%");for(var n=0;n<h.length;n++)n<g.index?h[n].$menuitem.find("div."+f.enableprogress).css("left",0):n>g.index&&h[n].$menuitem.find("div."+f.enableprogress).css("left","-100%")}}else if(o>v&&f.enableprogress){g.$menuitem.removeClass(f.highlightclass);for(var n=0;n<h.length;n++)h[n].$menuitem.find("div."+f.enableprogress).css("left",0)}}}function l(){if(0!=h.length){var e=h[0].$menu;u=c.outerHeight(),d=f.spytarget==window?n.get(0).scrollHeight:c.get(0).scrollHeight,v=0,p=-1;for(var t=0;t<h.length;t++){var o=h[t].$des,s=o.get(0),r=f.spytarget==window?o.offset().top:s.offsetParent==f.spytarget?s.offsetTop:s.offsetTop-f.spytarget.offsetTop;if(r+=f.scrolltopoffset,h[t].offsettop=r,h[t].height=parseInt(o.data("spyrange"))>0?parseInt(o.data("spyrange")):o.outerHeight()||f.mincontentheight,f.enableprogress){var i=r+h[t].height;-1==p&&i>d-u&&(p=t)}}v=h[h.length-1].offsettop+h[h.length-1].height}}var f=$.extend({},t,s);f.enableprogress=o?"":f.enableprogress;var h=[],g="",p=-1,c=$(f.spytarget).eq(0),u=c.outerHeight(),d=f.spytarget==window?n.get(0).scrollHeight:c.get(0).scrollHeight,m=$(this),v=0;i(m),m.on("updatespy",function(){i(m),a()}),c.on("scroll resize",function(){a()}),a(),r.on("load resize",function(){l()})})}}(jQuery);